<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Sinus: fréquence, phase, somme</title>
  <style>
    :root{
      --bg:#f6f7fb; --panel:#fff; --border:rgba(15,23,42,.14);
      --grid:rgba(15,23,42,.08); --text:#0f172a; --muted:rgba(15,23,42,.65);
      --blue:#2563eb; --sum:#16a34a;
    }
    *{ box-sizing:border-box; }
    body{
      margin:0; padding:16px;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      background:var(--bg); color:var(--text);
      display:flex; justify-content:center;
    }
    .card{
      width:min(860px, 96vw);
      background:var(--panel);
      border:1px solid var(--border);
      border-radius:12px;
      padding:12px;
      box-shadow:0 10px 22px rgba(15,23,42,.06);
    }
    h1{ margin:0 0 10px; font-size:16px; }

    .plots{
      display:grid;
      grid-template-columns: 1fr;
      gap:10px;
    }
    canvas{
      width:100%;
      height:260px;
      display:block;
      border:1px solid var(--border);
      border-radius:10px;
      background:linear-gradient(180deg, rgba(15,23,42,.02), transparent);
    }

    .controls{
      margin-top:10px;
      display:grid;
      gap:8px;
    }
    .row{
      display:grid;
      grid-template-columns: 130px 1fr 160px;
      gap:10px;
      align-items:center;
    }
    label{ color:var(--muted); font-size:13px; }
    input[type="range"]{ width:100%; }
    .val{
      text-align:right;
      font-variant-numeric:tabular-nums;
      font-size:13px;
      color:var(--muted);
    }

    .legend{
      margin-top:8px;
      display:flex;
      gap:14px;
      flex-wrap:wrap;
      color:var(--muted);
      font-size:13px;
    }
    .swatch{
      display:inline-block; width:12px; height:12px; border-radius:3px;
      margin-right:6px; vertical-align:-2px;
      border:1px solid rgba(15,23,42,.18);
    }
  </style>
</head>
<body>
  <div class="card">
    <h1>Deux sinus + somme</h1>

    <div class="plots">
      <canvas id="plot12"></canvas>
      <canvas id="plotSum"></canvas>
    </div>

    <div class="legend">
      <span><span class="swatch" style="background:#9aa3b2"></span>y₁(x) = sin(f·x)</span>
      <span><span class="swatch" style="background:var(--blue)"></span>y₂(x) = sin(f·x + φ)</span>
      <span><span class="swatch" style="background:var(--sum)"></span>y₁(x)+y₂(x)</span>
      <span style="opacity:.9;">(x ∈ [0, 2π])</span>
    </div>

    <div class="controls">
      <div class="row">
        <label for="freq">Fréquence f</label>
        <input id="freq" type="range" min="0.5" max="6" step="0.1" value="1.0" />
        <div class="val" id="freqVal">f = 1.0</div>
      </div>

      <div class="row">
        <label for="phase">Phase φ (bleu)</label>
        <input id="phase" type="range" min="-180" max="180" step="1" value="0" />
        <div class="val" id="phaseVal">φ = 0° (0.000 rad)</div>
      </div>
    </div>
  </div>

<script>
(() => {
  const plot12 = document.getElementById('plot12');
  const plotSum = document.getElementById('plotSum');

  const freqEl  = document.getElementById('freq');
  const phaseEl = document.getElementById('phase');
  const freqVal = document.getElementById('freqVal');
  const phaseVal= document.getElementById('phaseVal');

  const css = getComputedStyle(document.documentElement);
  const BLUE = css.getPropertyValue('--blue').trim();
  const SUM  = css.getPropertyValue('--sum').trim();

  function setupHiDPI(canvas){
    const dpr = Math.max(1, window.devicePixelRatio || 1);
    const r = canvas.getBoundingClientRect();
    canvas.width  = Math.round(r.width * dpr);
    canvas.height = Math.round(r.height * dpr);
    const ctx = canvas.getContext('2d');
    ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
    return ctx;
  }

  let ctx12 = setupHiDPI(plot12);
  let ctxS  = setupHiDPI(plotSum);

  window.addEventListener('resize', () => {
    ctx12 = setupHiDPI(plot12);
    ctxS  = setupHiDPI(plotSum);
    drawAll();
  });

  const fmt = (n,d=3) => {
    const x = Math.abs(n) < 1e-12 ? 0 : n;
    return x.toFixed(d);
  };
  const degToRad = (deg) => deg * Math.PI / 180;

  function drawGridAndAxes(ctx, w, h, pad, yRange=1) {
    const {L,R,T,B} = pad;
    const x0=L, y0=T, pw=w-L-R, ph=h-T-B;
    const yMid = y0 + ph/2;

    // grille
    ctx.save();
    ctx.strokeStyle = 'rgba(15,23,42,0.07)';
    ctx.lineWidth = 1;
    const stepX = 60, stepY = 50;
    for (let x = x0; x <= x0+pw; x += stepX) { ctx.beginPath(); ctx.moveTo(x,y0); ctx.lineTo(x,y0+ph); ctx.stroke(); }
    for (let y = y0; y <= y0+ph; y += stepY) { ctx.beginPath(); ctx.moveTo(x0,y); ctx.lineTo(x0+pw,y); ctx.stroke(); }
    ctx.restore();

    // axes
    ctx.save();
    ctx.strokeStyle = 'rgba(15,23,42,0.25)';
    ctx.lineWidth = 1.5;
    ctx.beginPath();
    ctx.moveTo(x0, yMid); ctx.lineTo(x0+pw, yMid);
    ctx.moveTo(x0, y0);   ctx.lineTo(x0, y0+ph);
    ctx.stroke();
    ctx.restore();

    // labels
    ctx.save();
    ctx.fillStyle = 'rgba(15,23,42,0.65)';
    ctx.font = '12.5px system-ui, -apple-system, Segoe UI, Roboto, Arial';
    // y labels selon amplitude
    ctx.fillText(String(yRange),  x0-18, y0+10);
    ctx.fillText('0',             x0-14, yMid+4);
    ctx.fillText(String(-yRange), x0-26, y0+ph-4);

    ctx.fillText('0',  x0-3, y0+ph+20);
    ctx.fillText('π',  x0 + pw/2 - 4, y0+ph+20);
    ctx.fillText('2π', x0 + pw - 14, y0+ph+20);
    ctx.restore();

    return {x0,y0,pw,ph};
  }

  function drawCurve(ctx, X, Y, color, fn) {
    ctx.save();
    ctx.strokeStyle = color;
    ctx.lineWidth = 3;
    ctx.beginPath();
    const N = 800;
    for (let i = 0; i <= N; i++) {
      const x = (i / N) * (2*Math.PI);
      const px = X(x);
      const py = Y(fn(x));
      if (i === 0) ctx.moveTo(px, py);
      else ctx.lineTo(px, py);
    }
    ctx.stroke();
    ctx.restore();
  }

  function drawAll() {
    const f = Number(freqEl.value);
    const phiDeg = Number(phaseEl.value);
    const phi = degToRad(phiDeg);

    freqVal.textContent = `f = ${fmt(f,1)}`;
    phaseVal.textContent = `φ = ${phiDeg}° (${fmt(phi,3)} rad)`;

    // --- Plot 1: y1 et y2 (amplitude [-1,1])
    {
      const w = plot12.getBoundingClientRect().width;
      const h = plot12.getBoundingClientRect().height;
      ctx12.clearRect(0,0,w,h);

      const pad = {L:46, R:16, T:16, B:34};
      const {x0,y0,pw,ph} = drawGridAndAxes(ctx12, w, h, pad, 1);

      const X = (x) => x0 + (x/(2*Math.PI))*pw;
      const Y = (v) => y0 + (1 - (v+1)/2)*ph;

      drawCurve(ctx12, X, Y, 'rgba(120,130,150,0.85)', (x) => Math.sin(f*x));
      drawCurve(ctx12, X, Y, BLUE, (x) => Math.sin(f*x + phi));

      // petit titre
      ctx12.save();
      ctx12.fillStyle = 'rgba(15,23,42,0.75)';
      ctx12.font = '12.5px system-ui, -apple-system, Segoe UI, Roboto, Arial';
      ctx12.fillText('y₁ et y₂', 54, 14);
      ctx12.restore();
    }

    // --- Plot 2: somme (amplitude [-2,2])
    {
      const w = plotSum.getBoundingClientRect().width;
      const h = plotSum.getBoundingClientRect().height;
      ctxS.clearRect(0,0,w,h);

      const pad = {L:46, R:16, T:16, B:34};
      const {x0,y0,pw,ph} = drawGridAndAxes(ctxS, w, h, pad, 2);

      const X = (x) => x0 + (x/(2*Math.PI))*pw;
      // ici v dans [-2,2]
      const Y = (v) => y0 + (1 - (v+2)/4)*ph;

      drawCurve(ctxS, X, Y, SUM, (x) => Math.sin(f*x) + Math.sin(f*x + phi));

      ctxS.save();
      ctxS.fillStyle = 'rgba(15,23,42,0.75)';
      ctxS.font = '12.5px system-ui, -apple-system, Segoe UI, Roboto, Arial';
      ctxS.fillText('Somme : y₁ + y₂', 54, 14);
      ctxS.restore();
    }
  }

  freqEl.addEventListener('input', drawAll);
  phaseEl.addEventListener('input', drawAll);
  drawAll();
})();
</script>
</body>
</html>